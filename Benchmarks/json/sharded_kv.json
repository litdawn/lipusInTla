{"location":"line 1, col 1 to line 71, col 4 of module sharded_kv","moduleInfo":{"location":"line 1, col 1 to line 1, col 27 of module sharded_kv","moduleName":"sharded_kv"},"extends":{"extendedModuleNames":["TLC","Randomization"],"location":"line 2, col 1 to line 2, col 26 of module sharded_kv"},"body":{"declaredParams":[{"location":"line 4, col 1 to line 4, col 12 of module sharded_kv","paramName":"Key"},{"location":"line 5, col 1 to line 5, col 14 of module sharded_kv","paramName":"Value"},{"location":"line 6, col 1 to line 6, col 13 of module sharded_kv","paramName":"Node"},{"location":"line 8, col 1 to line 8, col 12 of module sharded_kv","paramName":"Nil"}],"definedVariables":[{"variableName":"table"},{"variableName":"owner"},{"variableName":"transfer_msg"}],"location":"line 4, col 1 to line 69, col 31 of module sharded_kv","operatorDefinitions":[{"concreteContent":"vars == <<table, owner, transfer_msg>>","location":"line 19, col 1 to line 19, col 38 of module sharded_kv","operatorName":"vars","type":"State"},{"concreteContent":"Reshard(k,v,n_old,n_new) ==\n    /\\ table[n_old][k] = v\n    /\\ table' = [table EXCEPT ![n_old][k] = Nil]\n    /\\ owner' = [owner EXCEPT ![n_old] = owner[n_old] \\ {k}]\n    /\\ transfer_msg' = transfer_msg \\cup {<<n_new,k,v>>}\n","location":"line 21, col 1 to line 25, col 56 of module sharded_kv","operatorName":"Reshard","paramNum":4,"type":"Action"},{"concreteContent":"RecvTransferMsg(n, k, v) ==\n    /\\ <<n,k,v>> \\in transfer_msg\n    /\\ transfer_msg' = transfer_msg \\ {<<n,k,v>>}\n    /\\ table' = [table EXCEPT ![n][k] = v]\n    \\* Become the owner of this key.\n    /\\ owner' = [owner EXCEPT ![n] = owner[n] \\cup {k}]\n","location":"line 27, col 1 to line 32, col 55 of module sharded_kv","operatorName":"RecvTransferMsg","paramNum":3,"type":"Action"},{"concreteContent":"Put(n, k, v) == \n    /\\ k \\in owner[n]\n    /\\ table' = [table EXCEPT ![n][k] = v]\n    /\\ UNCHANGED <<owner, transfer_msg>>\n","location":"line 34, col 1 to line 37, col 40 of module sharded_kv","operatorName":"Put","paramNum":3,"type":"Action"},{"concreteContent":"Next == \n    \\/ \\E k \\in Key, v \\in Value, n_old,n_new \\in Node : Reshard(k,v,n_old,n_new)\n    \\/ \\E n \\in Node, k \\in Key, v \\in Value : RecvTransferMsg(n,k,v)\n    \\/ \\E n \\in Node, k \\in Key, v \\in Value : Put(n,k,v)\n","location":"line 39, col 1 to line 42, col 57 of module sharded_kv","operatorName":"Next","type":"State"},{"concreteContent":"Init == \n    /\\ table = [n \\in Node |-> [k \\in Key |-> Nil]]\n    \\* Each node owns some subset of keys, and different nodes\n    \\* can't own the same key.\n    /\\ owner \\in [Node -> SUBSET Key]\n    /\\ \\A i,j \\in Node : \\A k \\in Key : (k \\in owner[i] /\\ k \\in owner[j]) => (i=j)\n    /\\ transfer_msg = {}\n","location":"line 44, col 1 to line 50, col 24 of module sharded_kv","operatorName":"Init","type":"State"},{"concreteContent":"TypeOK ==\n    /\\ table \\in [Node -> [Key -> Value \\cup {Nil}]]\n    /\\ owner \\in [Node -> SUBSET Key]\n    /\\ transfer_msg \\in SUBSET (Node \\times Key \\times Value)\n","location":"line 52, col 1 to line 55, col 61 of module sharded_kv","operatorName":"TypeOK","type":"State"},{"concreteContent":"TypeOKRandom == \n    /\\ owner \\in [Node -> SUBSET Key]\n    /\\ table \\in [Node -> [Key -> Value \\cup {Nil}]]\n    /\\ transfer_msg \\in RandomSetOfSubsets(150, 5, (Node \\times Key \\times Value))\n","location":"line 57, col 1 to line 60, col 82 of module sharded_kv","operatorName":"TypeOKRandom","type":"State"},{"concreteContent":"Safety == \n    \\A n1,n2 \\in Node, k \\in Key, v1,v2 \\in Value : \n        (table[n1][k]=v1 /\\ table[n2][k]=v2) => (n1=n2 /\\ v1=v2)\n","location":"line 63, col 1 to line 65, col 64 of module sharded_kv","operatorName":"Safety","type":"State"},{"concreteContent":"Symmetry == Permutations(Key) \\cup Permutations(Value) \\cup Permutations(Node)","location":"line 67, col 1 to line 67, col 78 of module sharded_kv","operatorName":"Symmetry","type":"State"},{"concreteContent":"NextUnchanged == UNCHANGED vars","location":"line 69, col 1 to line 69, col 31 of module sharded_kv","operatorName":"NextUnchanged","type":"State"}]}}