{"location":"line 1, col 1 to line 274, col 76 of module Paxos","moduleInfo":{"location":"line 1, col 1 to line 1, col 77 of module Paxos","moduleName":"Paxos"},"extends":{"extendedModuleNames":["Integers","FiniteSets","TLC","Randomization"],"location":"line 6, col 1 to line 6, col 48 of module Paxos"},"body":{"declaredParams":[{"location":"line 11, col 1 to line 11, col 32 of module Paxos","paramName":"Value"}],"definedVariables":[{"variableName":"maxBal"},{"variableName":"maxVBal"},{"variableName":"maxVal"},{"variableName":"msgs"}],"location":"line 7, col 1 to line 255, col 77 of module Paxos","operatorDefinitions":[{"concreteContent":"Ballot ==  Nat","location":"line 16, col 1 to line 16, col 14 of module Paxos","operatorName":"Ballot","type":"State"},{"concreteContent":"None == CHOOSE v : v \\notin Value","location":"line 18, col 1 to line 18, col 33 of module Paxos","operatorName":"None","type":"State"},{"concreteContent":"Message ==      [type : {\"1a\"}, bal : Ballot]\n           \\cup [type : {\"1b\"}, acc : Acceptor, bal : Ballot, mbal : Ballot \\cup {-1}, mval : Value \\cup {None}]\n           \\cup [type : {\"2a\"}, bal : Ballot, val : Value]\n           \\cup [type : {\"2b\"}, acc : Acceptor, bal : Ballot, val : Value]\n","location":"line 28, col 1 to line 31, col 74 of module Paxos","operatorName":"Message","type":"State"},{"concreteContent":"vars == <<maxBal, maxVBal, maxVal, msgs>>","location":"line 57, col 1 to line 57, col 41 of module Paxos","operatorName":"vars","type":"State"},{"concreteContent":"TypeOK == /\\ maxBal \\in [Acceptor -> Ballot \\cup {-1}]\n          /\\ maxVBal \\in [Acceptor -> Ballot \\cup {-1}]\n          /\\ maxVal \\in [Acceptor -> Value \\cup {None}]\n          /\\ msgs \\subseteq Message\n","location":"line 66, col 1 to line 69, col 35 of module Paxos","operatorName":"TypeOK","type":"State"},{"concreteContent":"NumRandSubsets == 35","location":"line 72, col 1 to line 72, col 20 of module Paxos","operatorName":"NumRandSubsets","type":"State"},{"concreteContent":"kNumSubsets == 18","location":"line 74, col 1 to line 74, col 17 of module Paxos","operatorName":"kNumSubsets","type":"State"},{"concreteContent":"nAvgSubsetSize == 4","location":"line 75, col 1 to line 75, col 19 of module Paxos","operatorName":"nAvgSubsetSize","type":"State"},{"concreteContent":"TypeOKRandom == \n    /\\ maxBal \\in RandomSubset(NumRandSubsets, [Acceptor -> Ballot \\cup {-1}])\n    /\\ maxVBal \\in RandomSubset(NumRandSubsets, [Acceptor -> Ballot \\cup {-1}])\n    /\\ maxVal \\in RandomSubset(NumRandSubsets, [Acceptor -> Value \\cup {None}])\n    /\\ msgs \\in RandomSetOfSubsets(kNumSubsets, nAvgSubsetSize, Message)\n","location":"line 77, col 1 to line 81, col 72 of module Paxos","operatorName":"TypeOKRandom","type":"State"},{"concreteContent":"Init == /\\ maxBal = [a \\in Acceptor |-> -1]\n        /\\ maxVBal = [a \\in Acceptor |-> -1]\n        /\\ maxVal = [a \\in Acceptor |-> None]\n        /\\ msgs = {}\n","location":"line 84, col 1 to line 87, col 20 of module Paxos","operatorName":"Init","type":"State"},{"concreteContent":"Send(m) == msgs' = msgs \\cup {m}","location":"line 93, col 1 to line 93, col 32 of module Paxos","operatorName":"Send","paramNum":1,"type":"Action"},{"concreteContent":"msg1a(a,b) == \\E m \\in msgs : m.type= \"1b\" /\\ m.bal = a","location":"line 96, col 1 to line 96, col 55 of module Paxos","operatorName":"msg1a","paramNum":2,"type":"Action"},{"concreteContent":"msg1b(a,b,mb,v) == \\E m \\in msgs : m.type= \"1b\" /\\ m.acc = a /\\ m.bal = b /\\ m.mbal = mb /\\ m.mval = v","location":"line 97, col 1 to line 97, col 102 of module Paxos","operatorName":"msg1b","paramNum":4,"type":"Action"},{"concreteContent":"msg2a(b,v) == \\E m \\in msgs : m.type= \"2a\" /\\ m.bal = b /\\ m.val = v","location":"line 98, col 1 to line 98, col 68 of module Paxos","operatorName":"msg2a","paramNum":2,"type":"Action"},{"concreteContent":"msg2b(a,b,v) == \\E m \\in msgs : m.type= \"2b\" /\\ m.acc = a /\\ m.bal = b /\\ m.val = v","location":"line 99, col 1 to line 99, col 83 of module Paxos","operatorName":"msg2b","paramNum":3,"type":"Action"},{"concreteContent":"Phase1a(b) == /\\ Send([type |-> \"1a\", bal |-> b])\n              /\\ UNCHANGED <<maxBal, maxVBal, maxVal>>\n","location":"line 107, col 1 to line 108, col 54 of module Paxos","operatorName":"Phase1a","paramNum":1,"type":"Action"},{"concreteContent":"Phase1b(a) == /\\ \\E m \\in msgs : \n                  /\\ m.type = \"1a\"\n                  /\\ m.bal > maxBal[a]\n                  /\\ maxBal' = [maxBal EXCEPT ![a] = m.bal]\n                  /\\ Send([type |-> \"1b\", acc |-> a, bal |-> m.bal, \n                            mbal |-> maxVBal[a], mval |-> maxVal[a]])\n              /\\ UNCHANGED <<maxVBal, maxVal>>\n","location":"line 116, col 1 to line 122, col 46 of module Paxos","operatorName":"Phase1b","paramNum":1,"type":"Action"},{"concreteContent":"Q1b(Q, b) ==\n    {m \\in msgs : /\\ m.type = \"1b\"\n                  /\\ m.acc \\in Q\n                  /\\ m.bal = b}\n","location":"line 144, col 1 to line 147, col 31 of module Paxos","operatorName":"Q1b","paramNum":2,"type":"Action"},{"concreteContent":"Q1bv(Q, b) == {m \\in Q1b(Q,b) : m.mbal \\geq 0}","location":"line 149, col 1 to line 149, col 46 of module Paxos","operatorName":"Q1bv","paramNum":2,"type":"Action"},{"concreteContent":"Phase2a(b, v) ==\n  /\\ ~ \\E m \\in msgs : m.type = \"2a\" /\\ m.bal = b\n  /\\ \\E Q \\in Quorum :\n        /\\ \\A a \\in Q : \\E m \\in Q1b(Q,b) : m.acc = a \n        /\\ \\/ Q1bv(Q, b) = {}\n           \\/ \\E m \\in Q1bv(Q, b) : \n                /\\ m.mval = v\n                /\\ \\A mm \\in Q1bv(Q, b) : m.mbal \\geq mm.mbal \n  /\\ Send([type |-> \"2a\", bal |-> b, val |-> v])\n  /\\ UNCHANGED <<maxBal, maxVBal, maxVal>>\n","location":"line 151, col 1 to line 160, col 42 of module Paxos","operatorName":"Phase2a","paramNum":2,"type":"Action"},{"concreteContent":"Phase2b(a) == \\E m \\in msgs : /\\ m.type = \"2a\"\n                              /\\ m.bal \\geq maxBal[a]\n                              /\\ maxBal' = [maxBal EXCEPT ![a] = m.bal] \n                              /\\ maxVBal' = [maxVBal EXCEPT ![a] = m.bal] \n                              /\\ maxVal' = [maxVal EXCEPT ![a] = m.val]\n                              /\\ Send([type |-> \"2b\", acc |-> a,\n                                       bal |-> m.bal, val |-> m.val])\n","location":"line 171, col 1 to line 177, col 69 of module Paxos","operatorName":"Phase2b","paramNum":1,"type":"Action"},{"concreteContent":"Next == \n    \\/ \\E b \\in Ballot : Phase1a(b)\n    \\/ \\E b \\in Ballot : \\E v \\in Value : Phase2a(b, v)\n    \\/ \\E a \\in Acceptor : Phase1b(a) \n    \\/ \\E a \\in Acceptor : Phase2b(a)\n","location":"line 188, col 1 to line 192, col 37 of module Paxos","operatorName":"Next","type":"State"},{"concreteContent":"Spec == Init /\\ [][Next]_vars","location":"line 194, col 1 to line 194, col 29 of module Paxos","operatorName":"Spec","type":"State"},{"concreteContent":"votes == [a \\in Acceptor |->  \n           {<<m.bal, m.val>> : m \\in {mm \\in msgs: /\\ mm.type = \"2b\"\n                                                   /\\ mm.acc = a }}]\n","location":"line 206, col 1 to line 208, col 68 of module Paxos","operatorName":"votes","type":"State"},{"concreteContent":"VotedFor(a, b, v) == <<b, v>> \\in votes[a]","location":"line 210, col 1 to line 210, col 42 of module Paxos","operatorName":"VotedFor","paramNum":3,"type":"Action"},{"concreteContent":"ChosenAt(b, v) == \\E Q \\in Quorum : \\A a \\in Q : VotedFor(a, b, v)","location":"line 212, col 1 to line 212, col 66 of module Paxos","operatorName":"ChosenAt","paramNum":2,"type":"Action"},{"concreteContent":"chosen == {v \\in Value : \\E b \\in Ballot : ChosenAt(b, v)}","location":"line 214, col 1 to line 214, col 58 of module Paxos","operatorName":"chosen","type":"State"},{"concreteContent":"DidNotVoteAt(a, b) == \\A v \\in Value : ~ VotedFor(a, b, v)","location":"line 216, col 1 to line 216, col 58 of module Paxos","operatorName":"DidNotVoteAt","paramNum":2,"type":"Action"},{"concreteContent":"CannotVoteAt(a, b) == /\\ maxBal[a] > b\n                      /\\ DidNotVoteAt(a, b)\n","location":"line 218, col 1 to line 219, col 43 of module Paxos","operatorName":"CannotVoteAt","paramNum":2,"type":"Action"},{"concreteContent":"NoneOtherChoosableAt(b, v) == \n   \\E Q \\in Quorum : \n      \\A a \\in Q : VotedFor(a, b, v) \\/ CannotVoteAt(a, b)\n","location":"line 220, col 1 to line 222, col 58 of module Paxos","operatorName":"NoneOtherChoosableAt","paramNum":2,"type":"Action"},{"concreteContent":"SafeAt(b, v) == \\A c \\in 0..(b-1) : NoneOtherChoosableAt(c, v)","location":"line 224, col 1 to line 224, col 62 of module Paxos","operatorName":"SafeAt","paramNum":2,"type":"Action"},{"concreteContent":"ShowsSafeAt(Q, b, v) == \n  /\\ \\A a \\in Q : maxBal[a] >= b\n  /\\ \\E c \\in -1..(b-1) : \n      /\\ (c /= -1) => \\E a \\in Q : VotedFor(a, c, v)\n      /\\ \\A d \\in (c+1)..(b-1), a \\in Q : DidNotVoteAt(a, d)\n","location":"line 226, col 1 to line 230, col 60 of module Paxos","operatorName":"ShowsSafeAt","paramNum":3,"type":"Action"},{"concreteContent":"Inv == \n    /\\ Cardinality(chosen) <= 1\n","location":"line 232, col 1 to line 233, col 31 of module Paxos","operatorName":"Inv","type":"State"},{"concreteContent":"Ind ==\n    /\\ TypeOKRandom\n    /\\ Inv\n","location":"line 235, col 1 to line 237, col 10 of module Paxos","operatorName":"Ind","type":"State"},{"concreteContent":"Symmetry == Permutations(Acceptor) \\cup Permutations(Value)","location":"line 239, col 1 to line 239, col 59 of module Paxos","operatorName":"Symmetry","type":"State"},{"concreteContent":"NextUnchanged == UNCHANGED vars","location":"line 241, col 1 to line 241, col 31 of module Paxos","operatorName":"NextUnchanged","type":"State"},{"concreteContent":"K == \\A ACCI \\in Acceptor : (\\E m \\in msgs : m.bal >= maxBal[ACCI]) \\/ ((maxVBal[ACCI] = -1) /\\ (TRUE))","location":"line 243, col 1 to line 243, col 103 of module Paxos","operatorName":"K","type":"State"}]}}