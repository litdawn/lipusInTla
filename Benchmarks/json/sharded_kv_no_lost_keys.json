{"location":"line 1, col 1 to line 73, col 4 of module sharded_kv_no_lost_keys","moduleInfo":{"location":"line 1, col 1 to line 1, col 40 of module sharded_kv_no_lost_keys","moduleName":"sharded_kv_no_lost_keys"},"extends":{"extendedModuleNames":["TLC","Randomization"],"location":"line 2, col 1 to line 2, col 26 of module sharded_kv_no_lost_keys"},"body":{"declaredParams":[{"location":"line 4, col 1 to line 4, col 12 of module sharded_kv_no_lost_keys","paramName":"Key"},{"location":"line 5, col 1 to line 5, col 14 of module sharded_kv_no_lost_keys","paramName":"Value"},{"location":"line 6, col 1 to line 6, col 13 of module sharded_kv_no_lost_keys","paramName":"Node"},{"location":"line 8, col 1 to line 8, col 12 of module sharded_kv_no_lost_keys","paramName":"Nil"}],"definedVariables":[{"variableName":"table"},{"variableName":"owner"},{"variableName":"transfer_msg"}],"location":"line 4, col 1 to line 71, col 31 of module sharded_kv_no_lost_keys","operatorDefinitions":[{"concreteContent":"vars == <<table,owner,transfer_msg>>","location":"line 19, col 1 to line 19, col 36 of module sharded_kv_no_lost_keys","operatorName":"vars","type":"State"},{"concreteContent":"Reshard(k,v,n_old,n_new) ==\n    /\\ table[n_old][k] = v\n    /\\ table' = [table EXCEPT ![n_old][k] = Nil]\n    /\\ owner' = [owner EXCEPT ![n_old] = owner[n_old] \\ {k}]\n    /\\ transfer_msg' = transfer_msg \\cup {<<n_new,k,v>>}\n","location":"line 21, col 1 to line 25, col 56 of module sharded_kv_no_lost_keys","operatorName":"Reshard","paramNum":4,"type":"Action"},{"concreteContent":"RecvTransferMsg(n, k, v) ==\n    /\\ <<n,k,v>> \\in transfer_msg\n    /\\ transfer_msg' = transfer_msg \\ {<<n,k,v>>}\n    /\\ table' = [table EXCEPT ![n][k] = v]\n    \\* Become the owner of this key.\n    /\\ owner' = [owner EXCEPT ![n] = owner[n] \\cup {k}]\n","location":"line 27, col 1 to line 32, col 55 of module sharded_kv_no_lost_keys","operatorName":"RecvTransferMsg","paramNum":3,"type":"Action"},{"concreteContent":"Put(n, k, v) == \n    /\\ k \\in owner[n]\n    /\\ table' = [table EXCEPT ![n][k] = v]\n    /\\ UNCHANGED <<owner, transfer_msg>>\n","location":"line 34, col 1 to line 37, col 40 of module sharded_kv_no_lost_keys","operatorName":"Put","paramNum":3,"type":"Action"},{"concreteContent":"Next == \n    \\/ \\E k \\in Key, v \\in Value, n_old,n_new \\in Node : Reshard(k,v,n_old,n_new)\n    \\/ \\E n \\in Node, k \\in Key, v \\in Value : RecvTransferMsg(n,k,v)\n    \\/ \\E n \\in Node, k \\in Key, v \\in Value : Put(n,k,v)\n","location":"line 39, col 1 to line 42, col 57 of module sharded_kv_no_lost_keys","operatorName":"Next","type":"State"},{"concreteContent":"Init == \n    /\\ table = [n \\in Node |-> [k \\in Key |-> Nil]]\n    /\\ transfer_msg = {}\n    \\* Each node owns some subset of keys, and different nodes\n    \\* can't own the same key.\n    /\\ owner \\in [Node -> SUBSET Key]\n    /\\ \\A i,j \\in Node : \\A k \\in Key : (k \\in owner[i] /\\ k \\in owner[j]) => (i=j)\n    \\* No lost keys assumption: every key is owned by some node.\n    /\\ \\A k \\in Key : \\E n \\in Node : k \\in owner[n]\n","location":"line 44, col 1 to line 52, col 52 of module sharded_kv_no_lost_keys","operatorName":"Init","type":"State"},{"concreteContent":"TypeOK ==\n    /\\ table \\in [Node -> [Key -> Value \\cup {Nil}]]\n    /\\ owner \\in [Node -> SUBSET Key]\n    /\\ transfer_msg \\in SUBSET (Node \\X Key \\X Value)\n","location":"line 54, col 1 to line 57, col 53 of module sharded_kv_no_lost_keys","operatorName":"TypeOK","type":"State"},{"concreteContent":"TypeOKRandom == \n    /\\ owner \\in RandomSubset(35, [Node -> SUBSET Key])\n    /\\ table \\in RandomSubset(35, [Node -> [Key -> Value \\cup {Nil}]])\n    /\\ transfer_msg \\in RandomSetOfSubsets(35, 6, (Node \\times Key \\times Value))\n","location":"line 59, col 1 to line 62, col 81 of module sharded_kv_no_lost_keys","operatorName":"TypeOKRandom","type":"State"},{"concreteContent":"Safety == \n    \\/ \\E n \\in Node, k \\in Key, v \\in Value : <<n,k,v>> \\in transfer_msg \n    \\/ \\A k \\in Key : \\E n \\in Node : k \\in owner[n]\n","location":"line 65, col 1 to line 67, col 52 of module sharded_kv_no_lost_keys","operatorName":"Safety","type":"State"},{"concreteContent":"Symmetry == Permutations(Key) \\cup Permutations(Value) \\cup Permutations(Node)","location":"line 69, col 1 to line 69, col 78 of module sharded_kv_no_lost_keys","operatorName":"Symmetry","type":"State"},{"concreteContent":"NextUnchanged == UNCHANGED vars","location":"line 71, col 1 to line 71, col 31 of module sharded_kv_no_lost_keys","operatorName":"NextUnchanged","type":"State"}]}}